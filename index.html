<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>早餐奶</title>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'/>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/swiper.min.css">
<link rel="stylesheet" href="css/animate.min.css">
<script src="js/swiper.min.js"></script>
<script src="js/swiper.animate.min.js"></script>
<script src="js/autosize.js"></script>
</head>

<body>
<div class="papaLoad" id="papaLoad">
    <div class="loading">
        <img src="images/load.gif" alt="">
        努力加载中....
    </div>
</div>
<div class="logo">
    <img src="images/logo.png" alt="" />
</div>
<div class="music" id="music">
    <img id="music_ico" src="images/music_on.png" alt="" />
</div>
<audio id="audio" autoplay="autoplay" loop="loop" src="images/music.mp3"></audio>
<!--第一部分-->
<div class="swiper-container">
    <div class="swiper-wrapper" id="slide_index">
        <section class="swiper-slide swiper-slide1 swiper-no-swiping">
        <img src="images/title_01.png" class="ani resize" style="width:100%;right:-3%;top:17%;z-index:3;" swiper-animate-effect="zoomIn" swiper-animate-duration="1.5s" swiper-animate-delay="0s"  >
        <img src="images/bottle.png" class="ani resize" style="width:100%;right:0%;top:42%;z-index:4;" swiper-animate-effect="zoomIn" swiper-animate-duration="1.5s" swiper-animate-delay="0s"  >
        <img src="images/mum_01.png" class="ani resize mum_01" style="width:18%;left:10%;top:50%;z-index:5;" swiper-animate-effect="fadeInLeft" swiper-animate-duration="1.5s" swiper-animate-delay="1.5s"  >
        <img src="images/mum_say_01.png" class="ani resize say_01" style="width:30%;left:27%;top:51%;z-index:6;" swiper-animate-effect="zoomIn" swiper-animate-duration="1.5s" swiper-animate-delay="2s"  >
        <img src="images/mum_02.png" class="ani resize mum_02" style="width:23%;left:8%;top:40%;z-index:5;" swiper-animate-effect="fadeInLeft" swiper-animate-duration="2s" swiper-animate-delay="3.5s"  >
        <img src="images/mum_say_02.png" class="ani resize say_02" style="width:30%;left:27%;top:51%;z-index:6;" swiper-animate-effect="zoomIn" swiper-animate-duration="2s" swiper-animate-delay="4s"  >
         <img src="images/mum_03.png" class="ani resize mum_03" style="width:40%;left:4%;top:40%;z-index:5;" swiper-animate-effect="fadeInLeft" swiper-animate-duration="2s" swiper-animate-delay="6.5s"  >
        <img src="images/mum_say_03.png" class="ani resize say_03" style="width:30%;left:27%;top:51%;z-index:6;" swiper-animate-effect="zoomIn" swiper-animate-duration="2s" swiper-animate-delay="7s"  >
        <img src="images/child.png" class="ani resize" style="width:16%;right:8%;top:63%;z-index:6;" swiper-animate-effect="fadeInRight" swiper-animate-duration="1.5s" swiper-animate-delay="1.5s"  >
        <img src="images/text_01.png" class="ani resize" style="width:100%;left: 0;top:28%;z-index:3;" swiper-animate-effect="fadeInLeft" swiper-animate-duration="1.5s" swiper-animate-delay="1s"  >
        <img class="down_ico" src="images/down_ico.png" />
        </section>
   </div>
 </div>
<!--第二部分-->
 <div class="slide_02">
   <img src="images/slide_02.png" />
 </div>
<!--第三部分-->
 <div class="slide_03">
     <p class="drag_text_tips">拖动选择下面的一款食物，搭配牛奶吧</p>
   <input class="usertext" type="" name="" placeholder="请输入你想要的牛奶" >
   <div class="dish_cotent">
       <div class="bottle_small" name="牛奶" id="bottle_small">
           <img src="images/bottle_test.png" />
       </div>
       <div class="plate">
           <img src="images/plate.png" />
       </div>

   </div>
     <div class="dish_wrap">
         <div class="dish dish_01" name="麦片" id="dish_01">
             <img src="images/dish_01.png" />
         </div>
         <div class="dish dish_02" name="面包" id="dish_02">
             <img src="images/dish_02.png" />
         </div>
         <div class="dish dish_03" name="鸡蛋" id="dish_03">
             <img src="images/dish_03.png" />
         </div>
         <div class="dish dish_04" name="核桃" id="dish_04">
             <img src="images/dish_04.png" />
         </div>
         <div class="dish dish_05" name="猕猴桃" id="dish_05">
             <img src="images/dish_05.png" />
         </div>
     </div>
    <div class="slide_03_text">
      <img src="images/slide_03_text.png" />
   </div>
     <div class="slide_03_btn btn">
           <img src="images/sure_btn.png" />
       </div>
 </div>
<!--第四部分-->
 <div class="slide_04" >
     <div class="rule_btn">
         <img src="images/rul_btn.png" alt="" />
     </div>
     <div class="dish_cotent dish_cotent_clone">
       <div class="bottle_small" id="bottle_small_clone">
           <img src="images/bottle_test.png" />
       </div>
       <div class="plate">
           <img src="images/plate_clone.png" />
       </div>
   </div>
     <div class="dish_wrap dish_wrap_clone">
         <div class="dish dish_01" id="dish_01_clone">
             <img src="images/dish_01.png" />
         </div>
         <div class="dish dish_02" id="dish_02_clone">
             <img src="images/dish_02.png" />
         </div>
         <div class="dish dish_03" id="dish_03_clone">
             <img src="images/dish_03.png" />
         </div>
         <div class="dish dish_04" id="dish_04_clone">
             <img src="images/dish_04.png" />
         </div>
         <div class="dish dish_05" id="dish_05_clone">
             <img src="images/dish_05.png" />
         </div>
     </div>
    <a href="javascript:;" class="yao_btn_01">
      <img src="images/share_btn.png" />
    </a>
     <a href="https://h5.koudaitong.com/v2/showcase/homepage?alias=eptom893" class="yao_btn_02">
         <img src="images/link_ico.png" />
     </a>
     <div class="yao_mum">
         <img src="images/mum_01.png" alt="" />
     </div>
     <div class="yao_child">
         <img src="images/child.png" alt="" />
     </div>
     <div class="yao_text">
         <img src="images/yao_text.png" alt="" />
     </div>
     <ul class="user_list">
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
         <li>
             <img src="images/user_ico.jpg" alt="" />
         </li>
     </ul>
 </div>
<!--第五部分-->
<div class="slide_05">
    <div class="slide_05_mum">
        <img src="images/mum_01.png" alt="" />
    </div>
    <div class="slide_05_text">
        <img src="images/text_bg.png" alt="" />
    </div>
    <textarea class="textarea_01" placeholder="写下送给孩子的话"></textarea>
    <textarea class="textarea_02" placeholder="你认为妈妈的早餐是什么样的?"></textarea>
    <div class="slide_05_btn btn">
        <img src="images/sure_btn.png" />
    </div>
</div>
<!--摇一摇第六部分-->
<div class="slide_06">
    <div class="slide_06_bg">
        <img src="images/yao_bg.jpg" alt="" />
        <div class="slide_06_plate">
            <img src="images/plate.png" alt="" />
        </div>
        <div class="slide_06_text">
            <img src="images/slide_06_text.png" alt="" />
        </div>
        <div class="milk_01">
            <img src="images/milk_01.png" alt="" />
        </div>
        <div class="milk_02">
            <img src="images/milk_02.png" alt="" />
        </div>
        <div class="yao_tips_01">
            <img src="images/yao_tips_01.png" alt="" />
        </div>
        <div class="yao_tips_02">
            <img src="images/yao_tips_02.png" alt="" />
        </div>
    </div>
</div>
<!--分享部分-->
<div class="share_wrap">
    <div class="share_tips">
        <img src="images/share_tips.png" alt="" />
    </div>
</div>
<!--规则部分-->
<div class="rule_wrap">
    <div class="rule_text">
        <h3>活动规则</h3>
        <p>1、活动时间：即日起—11月13日</p>
        <p>2、活动参与者，在活动期间召集10位伙伴参加活动，即可花费11.11元成功购买妈妈的早餐15天体验权</p>
        <p>3、提交订单付款后，系统会自动识别，十人成团后默认拼团成功。若拼团不成功，则费用按原路退回。</p>
        <p>4、本次活动总共提供10000份产品，售完为止</p>
        <p>5、本产品为预售产品，预计12月可送货，届时会有相关的工作人员同您联系</p>
        <p>6、本活动仅限成都市区使用，其他地区暂不支持</p>
        <p>7、本活动解释权归新希望华西乳业所有，如有疑问，请致电：XXXX</p>
    </div>
    <div class="share_back_btn">
        <img src="images/back.png" />
    </div>
</div>
<script src="js/jquery-1.8.3.min.js"></script>
<script src="js/hammer.min.js"></script>
<script>

    window.onload=function(){
        var $loading = document.getElementById('papaLoad');
        $loading.parentNode.removeChild($loading);
        setTimeout(function(){
          $('.mum_01,.say_01').fadeOut()
       },3500);
        setTimeout(function(){
          $('.mum_02,.say_02').fadeOut()
       },6000);
        setTimeout(function(){
          $('.down_ico').show();
//            document.getElementById('slide_index').addEventListener('click',function(){
//                console.log(1)
//                $('.slide_02').fadeIn();
//            });
            indexTouch()
 },9000);
        //   向上滑动动作
        function indexTouch(){
            $(".swiper-container").bind("touchstart", function(e) {
                e.preventDefault()
                startX = e.originalEvent.changedTouches[0].pageX,
                        startY = e.originalEvent.changedTouches[0].pageY;
            });
            $(".swiper-container").bind("touchmove", function(e) {
                e.preventDefault()
                moveEndX = e.originalEvent.changedTouches[0].pageX,
                        moveEndY = e.originalEvent.changedTouches[0].pageY,
                        X = moveEndX - startX,
                        Y = moveEndY - startY;

                if ( Y < -10||Y==0 ) {
                    $('.slide_02').fadeIn();
                }
            });
//            $(".swiper-container").bind("touchend", function(e) {
//                $(".swiper-container").unbind('touchmove');
//            });
        }
        var mySwiper = new Swiper ('.swiper-container', {
            direction : 'vertical',
            pagination: '.swiper-pagination',
            //virtualTranslate : true,
            mousewheelControl : true,
            onInit: function(swiper){
                swiperAnimateCache(swiper);
                swiperAnimate(swiper);
            },
            onSlideChangeEnd: function(swiper){
                swiperAnimate(swiper);
            },
            onTransitionEnd: function(swiper){
                swiperAnimate(swiper);
            }
        });
//        摇一摇动作

//获取加速度信息
//通过监听上一步获取到的x, y, z 值在一定时间范围内的变化率，进行设备是否有进行晃动的判断。
//而为了防止正常移动的误判，需要给该变化率设置一个合适的临界值。
        var SHAKE_THRESHOLD = 4000;
        var last_update = 0;
        var x, y, z, last_x = 0, last_y = 0, last_z = 0;

        function deviceMotionHandler(eventData) {
            var acceleration =eventData.accelerationIncludingGravity;
            var curTime = new Date().getTime();
            if ((curTime-last_update)> 10) {
                var diffTime = curTime -last_update;
                last_update = curTime;
                x = acceleration.x;
                y = acceleration.y;
                z = acceleration.z;
                var speed = Math.abs(x +y + z - last_x - last_y - last_z) / diffTime * 10000;
                if (speed > SHAKE_THRESHOLD) {
                    $('.slide_06_text').fadeOut();
                    $('.milk_01').animate({top:'0'},1000);
                    $('.milk_02').show().animate({bottom:'0'},2000);
                    $('.yao_tips_01').animate({top:'5%'},1500);
                    $('.yao_tips_02').show().animate({bottom:'5%'},2000);
                    setTimeout(function(){
                        $('.slide_06').fadeOut();
                        $('.slide_04').fadeIn();
                    },2500);
                }
                last_x = x;
                last_y = y;
                last_z = z;
            }
        }

//        拖拽操作
        //获取相关CSS属性
        var getCss = function(o,key){
            return o.currentStyle? o.currentStyle[key] : document.defaultView.getComputedStyle(o,false)[key];
        };
        var str = '牛奶';
        function drag(element,cloneElement,name){
            element.style.top =getCss(element,"top");
            element.style.left = getCss(element,"left");
            var hammer = new Hammer(element);//hammer实例
            var x = 0;
            var y = 0;
            hammer.on('panstart',function(event){
                $('.drag_text_tips').hide();
                x = parseInt(element.style.left);
                y = parseInt(element.style.top);
            });
            hammer.on('panmove',function(event){
                element.style.top = y + event.deltaY + "px";
                element.style.left = x + event.deltaX + "px";
            });
            hammer.on('panend',function(event){
                cloneElement.style.display = 'block';
                cloneElement.style.top =  y + event.deltaY + "px";
                cloneElement.style.left =  x + event.deltaX + "px";
                if (str.indexOf(name)==-1) {
                    str=str+' '+name;
                }
                $('.usertext').val(str);
                element.setAttribute('name','')
            });

        }
      //拖拽操作
        var arraylist = ['dish_01','dish_02','dish_03','dish_04','dish_05','bottle_small'];
        var arraylist_clone = ['dish_01_clone','dish_02_clone','dish_03_clone','dish_04_clone','dish_05_clone','bottle_small_clone'];
        for(var i=0;i<arraylist.length;i++){
            drag(document.getElementById(arraylist[i]),document.getElementById(arraylist_clone[i]),document.getElementById(arraylist[i]).getAttribute('name'))
        }

      //页面跳转流程
        $('.slide_02').click(function(){
            $('.swiper-container,.slide_02').hide();
            $('.slide_03').fadeIn();
        });
//        第三部分点击按钮
        $('.slide_03_btn').click(function(){
            $('.drag_text_tips').hide();
            $('.slide_05').fadeIn();
        });
//        妈妈说的话确定按钮
        $('.slide_05_btn').click(function(){
            $('.slide_05').hide();
            $('.slide_03').hide();
            $('.slide_06').fadeIn();
            //运动事件监听
            if (window.DeviceMotionEvent) {
                window.addEventListener('devicemotion',deviceMotionHandler,false);
            }
        });
//        分享点击
        $('.yao_btn_01').click(function(){
            $('.share_wrap').show();
        });
        $('.share_wrap').click(function(){
            $(this).hide();
        });
//        规则点击
        $('.rule_btn').click(function(){
            $('.rule_wrap').show();
        });
        $('.share_back_btn').click(function(){
            $('.rule_wrap').hide();
        });
//        控制音乐
        var flag = true;
        var music = document.getElementById('music');
        var musicIco = document.getElementById('music_ico');
        var audio = document.getElementById('audio');
        music.addEventListener('click',function(){
            if(flag){
                musicIco.src = "images/music_off.png";
                flag = false;
                audio.pause();
            }
            else{
                musicIco.src = "images/music_on.png";
                flag = true;
                audio.play();
            }
        });

    };
</script>

</body>
</html>
